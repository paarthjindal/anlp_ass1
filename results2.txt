
 # Configuration - Simplified for better learning
    config = {
        'd_model': 256,  # Reduced from 512 to 256 for easier training
        'num_heads': 8,
        'num_encoder_layers': 4,  # Reduced from 6 to 4
        'num_decoder_layers': 4,  # Reduced from 6 to 4
        'd_ff': 1024,  # Reduced from 2048 to 1024
        'max_seq_len': 128,
        'dropout': 0.2,  # Increased from 0.1 to 0.2 for better regularization
        'pos_encoding_type': 'rope',
        'batch_size': 16,  # Reduced from 32 to 16 for more stable gradients
        'learning_rate': 1e-3,  # Increased from 2e-4 to 1e-3 for faster learning
        'num_epochs': 10,  # Increased from 10 to 15 for more training time
        'warmup_steps': 500,  # Reduced from 2000 to 500 for faster ramp-up
        'vocab_size': 10000,
        'save_every': 1000,
        'eval_every': 200,  # More frequent evaluation
        'label_smoothing': 0.0,  # Completely disabled
        'use_label_smoothing': False,  # Ensure cross entropy is used
        'weight_decay': 1e-4,  # Add weight decay for regularization
        'gradient_clip': 0.5  # Reduced gradient clipping
    }


Decoding strategy Greedy


ğŸ“ Data path: /kaggle/input/anlp-ass1
ğŸ“ Working directory: /kaggle/working
âœ… Successfully imported custom modules
ğŸ”§ Configuration:
   DATA_PATH: /kaggle/input/anlp-ass1
============================================================
ğŸš€ Starting Transformer Testing on Kaggle
============================================================
ğŸ”§ Using device: cuda
   GPU: Tesla T4
   CUDA version: 12.4
ğŸ“¥ Using model: /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
ğŸ“¥ Loading model from /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
âœ… Model loaded successfully!
ğŸ”§ Positional encoding: rope
ğŸ”§ Using RoPE (Rotary Position Embeddings)
ğŸ“Š Source vocab size: 10,000
ğŸ“Š Target vocab size: 10,000
ğŸ¤– Model parameters: 15,053,584

============================================================
ğŸ§ª Testing sample sentences...

============================================================
ğŸ§ª SAMPLE SENTENCE TESTING
============================================================

1. Finnish: HyvÃ¤Ã¤ huomenta
   Greedy:       the european
   Conservative: i that the and to the european
   Balanced:     of the
   Creative:     the should
   Beam:         <UNK>

2. Finnish: Kiitos paljon
   Greedy:       the european
   Conservative: it on the european which
   Balanced:     debates of this
   Creative:     i not
   Beam:         <UNK>

3. Finnish: NÃ¤hdÃ¤Ã¤n myÃ¶hemmin
   Greedy:       the european
   Conservative: but we
   Balanced:     that the union to a
   Creative:     am
   Beam:         <UNK>

4. Finnish: MikÃ¤ on nimesi?
   Greedy:       the european of the european
   Conservative: the - are
   Balanced:     on the which is should to the also of the very
   Creative:     the structural report for the european to the very
   Beam:         <UNK>

5. Finnish: PidÃ¤n kahvista
   Greedy:       the european
   Conservative: the european
   Balanced:     that the commission
   Creative:     the various there
   Beam:         <UNK>

6. Finnish: SÃ¤Ã¤ on kaunis tÃ¤nÃ¤Ã¤n
   Greedy:       the european of the european
   Conservative: we is the european in not to with of the commission
   Balanced:     must the and in the
   Creative:     in i must be them to make to like
   Beam:         <UNK>

7. Finnish: Voitko auttaa minua?
   Greedy:       the european of the european
   Conservative: the not to be of the european
   Balanced:     the no and that that
   Creative:     in and or the but of the -
   Beam:         <UNK>

8. Finnish: Olen opiskelija
   Greedy:       the european
   Conservative: the european
   Balanced:     i on the
   Creative:     more that the council at in the european should are been
   Beam:         <UNK>

ğŸ’¾ Sample translations saved to /kaggle/working/sample_translations.csv

============================================================
ğŸ¯ Running single strategy evaluation...
Selected strategy: greedy

================================================================================
ğŸ¯ SINGLE STRATEGY EVALUATION: GREEDY
================================================================================
ğŸ“ Loading test data...
âœ… Using full test set: 10,000 sentences

ğŸ“Š Test set size: 10000 sentence pairs
ğŸ¤– Model: rope positional encoding
âš™ï¸  Parameters: 15,053,584
ğŸ­ Strategy: GREEDY
================================================================================
âš¡ Generating translations with Greedy decoding...
Greedy Translation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [21:45<00:00,  7.66it/s]

ğŸ“ Translation Examples (first 5):

--- Example 1 ---
Source (FI):  Ottaen huomioon sen vÃ¤Ã¤rÃ¤n tavan, jota komissio on noudattanut hyvÃ¤ksyessÃ¤Ã¤n laskuja, tuen esittelijÃ¤n vaati musta tilinpÃ¤Ã¤tÃ¶ksen lykkÃ¤Ã¤misestÃ¤.
Reference:    In toe tight of toe incorrect use toe Commission has made of approving toe accounts I support toe rapporteur in postponing toe discharge decisions.
Greedy      : the european of the european of the european of the european

--- Example 2 ---
Source (FI):  Kerron teille tositapauksen, joka ei ole vitsi, vaan joka tapahtui viime viikolla.
Reference:    We were successful in introducing reports on the structural funds and major programmes like Phare, Tacis, Meda, and so on.
Greedy      : the european of the european of the european

--- Example 3 ---
Source (FI):  WienissÃ¤ vuonna 1994 perustettu eurooppalaisten naisten terveysverkosto luki naisiin kohdistuneen vÃ¤kivallan osaksi kuutta ensisijaista huolenaihetta terveydenhuollon alalla. Vaikka mainittu vÃ¤kivalta ei tunne sosiaaliskulttuurisia, uskonnollisia tai rodullisia rajoja, niin kaikkein haavoittuvimpia ovat lasten ohella nuoret ja kÃ¶yhÃ¤t siirto laisnaiset.
Reference:    The European Women's Health Network which was created in Vienna in 1994 included violence against women among its six basic health concerns, and although such violence has no sociocultural, religious or racial boundaries, the most vulnerable are young, migrant, poor women, and children.
Greedy      : the european of the european to the european of the european and the european of the european of the european of the european of the european of the european of the european of the european of the european of the european

--- Example 4 ---
Source (FI):  On totta, ettÃ¤ EU ei ole kyennyt panemaan tÃ¤ytÃ¤ntÃ¶Ã¶n sen sopimuksiin sisÃ¤ltyviÃ¤ perusihmisoikeuksia ja demokratialausekkeita.
Reference:    Passing the hat round and trying to move things from pillar to post is not the model way of doing things.
Greedy      : the european of the european to the european and the european

--- Example 5 ---
Source (FI):  Wohlfart. - (FR) Slovenian osalta on sovellettu muun laista ratkaisua. Tsekin tasavallan ja muiden assosiaatiosopimuksen allekirjoittaneiden maiden osalta ongelmat ovat neuvoston mielestÃ¤ samankaltaisia, mutta ilmenevÃ¤t eri yhteyksissÃ¤.
Reference:    Alavanos (GUE/NGL). - (EL) Mr President, I would Uke to thank you for having created a precedent and for having thus enabled my question to be debated, and for the wisdom you and the President-in-Office have shown when tackling this issue.
Greedy      : the european of the european of the european of the european and the european of the european

ğŸ“ˆ EVALUATION RESULTS
==================================================
ğŸ¯ BLEU Score (greedy): 0.0195

ğŸ“Š DETAILED METRICS:
  BLEU Score:      0.0195
  Exact Match:     0.00%
  Word Accuracy:   2.49%
  Avg Length:      12.7 words (ref: 22.9)

ğŸ’¾ Results saved:
  ğŸ“„ Detailed results: /kaggle/working/greedy_test_results.csv
  ğŸ“Š Summary metrics: /kaggle/working/greedy_evaluation_summary.json
================================================================================

âœ… Testing completed successfully!
ğŸ¯ BLEU Score (greedy): 0.0195
ğŸ“Š Test Sentences: 10,000
ğŸ­ Strategy: GREEDY