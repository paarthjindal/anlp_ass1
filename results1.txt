# Model Configuration
config = {
    'pos_encoding_type': 'rope',        # ğŸ”§ RoPE Positional Encoding
    'd_model': 256,                     # Model dimension
    'num_heads': 8,                     # Multi-head attention
    'num_encoder_layers': 4,            # Encoder layers
    'num_decoder_layers': 4,            # Decoder layers
    'd_ff': 1024,                       # Feed-forward dimension
    'max_seq_len': 128,                 # Maximum sequence length
    'dropout': 0.2                      # Dropout rate
}

Decoding strategy balance top k

============================================================
ğŸ¯ Running single strategy evaluation...
Selected strategy: balanced

================================================================================
ğŸ¯ SINGLE STRATEGY EVALUATION: BALANCED
================================================================================
ğŸ“ Loading test data...
âœ… Using full test set: 10,000 sentences

ğŸ“Š Test set size: 10000 sentence pairs
ğŸ¤– Model: rope positional encoding
âš™ï¸  Parameters: 15,053,584
ğŸ¯ Strategy: BALANCED
================================================================================
âš–ï¸  Generating translations with balanced top-k (k=50, p=0.9)...
Balanced: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [34:11<00:00,  4.87it/s]

ğŸ“ Translation Examples (first 10):

--- Example 1 ---
Source (FI):  Tarkistuksen 12 on tarkoitus edelleen tehdÃ¤ sel vÃ¤ksi, ettÃ¤ nÃ¤mÃ¤ valtion tuet ovat viimeisiÃ¤, joita asian osaisille telakoille voidaan hyvÃ¤ksyÃ¤.
Reference:    That is precisely why we believe in principle what we are doing today is a virtual abdication of parliamentary rights of review.
Balanced    : we of their is the not for the european that the council to the single a of the and to by the council in the european is the single and the commission and be mr to be only

--- Example 2 ---
Source (FI):  Petosten vastainen yk sikkÃ¶, UCLAF, tekee hyvÃ¤Ã¤ ja menestyksekÃ¤stÃ¤ tyÃ¶tÃ¤.
Reference:    objected to the Court of Auditors becoming involved in what is a strictly political matter.
Balanced    : it is a of the european and for to be would in the commission of the of the european

--- Example 3 ---
Source (FI):  LisÃ¤tietoja saa Euroopan parlamentin jÃ¤seniltÃ¤ tai henkilÃ¶iden, tavaroiden, palvelujen ja pÃ¤Ã¤omien vapaa liikkuvuus
Reference:    You may also seek any information you require from a member of the European Parliament or from the
Balanced    : is - the commission in the european but should on from the i and that of the you of the community

--- Example 4 ---
Source (FI):  Kun ongelma otettiin esille maatalousministerien neuvostossa marraskuussa, komissaari Fischler lupasi "seurata kehitystÃ¤ tarkoin".
Reference:    When this problem was raised at the November CouncU of Agriculture Ministers, Commissioner Fischler agreed 'to keep a watchful eye on developments'.
Balanced    : a of toe the european committee the with the at the of the not on the european

--- Example 5 ---
Source (FI):  TyÃ¶paikkojen luominen.
Reference:    Next, job creation.
Balanced    : the in a

--- Example 6 ---
Source (FI):  Voidaan tietenkin aina pohtia pikkuseikkoja, mutta on osittain brittien hallituksen myÃ¶ntyvyyden ansiota, ettei asia ole enÃ¤Ã¤ kiistanalainen.
Reference:    Of course, one can always argue about the finer details, but it is mainly thanks to the agreement of the new British Government that it is no longer a controversial issue.
Balanced    : we i of the but in this and the an the member of the some and the for has are

--- Example 7 ---
Source (FI):  Kyseinen direktiivi ansaitsee kuitenkin tulla huomatuksi, enkÃ¤ halua kieltÃ¤Ã¤ sitÃ¤, ettÃ¤ tietyissÃ¤ jÃ¤senvaltioissa asiaa on edistetty. Useimmissa jÃ¤senvaltiossa itsenÃ¤isten ammatin harjoittajien avustavat aviopuolisot ovat kuitenkin edelleen nÃ¤kymÃ¤ttÃ¶miÃ¤ tyÃ¶ntekijÃ¶itÃ¤, joita ei oteta lukuun, vielÃ¤ yli kymmenen vuotta kyseisen dkektiivin antamisen jÃ¤lkeenkin.
Reference:    I would not deny the fact toat progress has been made in some Member States, but, more than 10 years after the adoption of the directive, the majority of spouses participating in toe activities of the selfemployed are forgotten people, invisible workers.
Balanced    : but a is as it has the european be this to the - and the an on the only a no be at the european of the not of not of - have of there to will be in have

--- Example 8 ---
Source (FI):  Toinen on kysymys siitÃ¤, miten hinnat ilmoitetaan, nimittÃ¤in kysymys hintojen merkitsemisestÃ¤ tai hintojen ilmoittamisesta.
Reference:    We have an amend ment here which also protects, I am very glad to say, those who are seUing products where the total price is not the unit price.
Balanced    : the european and i the also this on the european for the which

--- Example 9 ---
Source (FI):  Kehotan myÃ¶s ystÃ¤viÃ¤ni Ã¤Ã¤nestÃ¤mÃ¤Ã¤n FourÃ§ansin mietintÃ¶Ã¤ vastaan, vaikka sydÃ¤meni vuotaa verta, kun ajattelen ystÃ¤vÃ¤Ã¤ni FourÃ§ansia.
Reference:    I think it would have been harmful to grant broadcasting monopolies, for the sake of commercial and financial interest.
Balanced    : that is it is in a the commission to the on the european on the commission has committee in the european

--- Example 10 ---
Source (FI):  Seuraavaksi on vuorossa tÃ¤mÃ¤n Ã¤Ã¤nestyksen kolmas ja viimeinen kierros ehdokas PodestÃ sta.
Reference:    President. - I shall be very pleased, Mr Elliott, to consult the Committee on the Rules of Procedure and put to them the proposal that you have made about whether the system should be changed.
Balanced    : it is that the commission parliament of the have of the an with of the not of the commission and i with

================================================================================
ğŸ“ˆ BLEU SCORE EVALUATION
================================================================================
ğŸ¯ BLEU Score (balanced): 0.0711

ğŸ“Š DETAILED METRICS:
  BLEU Score:      0.0711
  Exact Match:     0.00%
  Word Accuracy:   2.12%
  Avg Pred Length: 19.6 words
  Avg Ref Length:  23.5 words

ğŸ” TRANSLATION QUALITY ANALYSIS:
  UNK tokens:      0/10000 (0.0%)
  Empty outputs:   45/10000 (0.4%)
  Very short:      355/10000 (3.5%)

ğŸ† FINAL SUMMARY:
  Strategy: BALANCED
  Test sentences: 10,000
  BLEU Score: 0.0711
  Model quality: ğŸŸ¡ Fair
================================================================================

ğŸ’¾ Results saved:
  ğŸ“„ Detailed results: /kaggle/working/single_strategy_balanced_results.csv
  ğŸ“Š Summary: /kaggle/working/single_strategy_balanced_summary.json

âœ… Testing completed successfully!
ğŸ¯ BLEU Score (balanced): 0.0711
ğŸ“Š Test Sentences: 10,000
ğŸ­ Strategy: BALANCED
