    config = {
        'd_model': 256,  # Reduced from 512 to 256 for easier training
        'num_heads': 8,
        'num_encoder_layers': 4,  # Reduced from 6 to 4
        'num_decoder_layers': 4,  # Reduced from 6 to 4
        'd_ff': 1024,  # Reduced from 2048 to 1024
        'max_seq_len': 128,
        'dropout': 0.2,  # Increased from 0.1 to 0.2 for better regularization
        'pos_encoding_type': 'relative_bias',  # Changed from 'rope' to 'relative_bias'
        'batch_size': 16,  # Reduced from 32 to 16 for more stable gradients
        'learning_rate': 1e-3,  # Increased from 2e-4 to 1e-3 for faster learning
        'num_epochs': 15,  # Increased from 10 to 15 for more training time
        'warmup_steps': 500,  # Reduced from 2000 to 500 for faster ramp-up
        'vocab_size': 10000,
        'save_every': 1000,
        'eval_every': 200,  # More frequent evaluation
        'label_smoothing': 0.0,  # Completely disabled
        'use_label_smoothing': False,  # Ensure cross entropy is used
        'weight_decay': 1e-4,  # Add weight decay for regularization
        'gradient_clip': 0.5,  # Reduced gradient clipping
        # Relative position bias specific parameters
        'relative_attention_num_buckets': 32,  # Number of relative position buckets
        'relative_attention_max_distance': 128,  # Maximum relative distance
    }


ğŸ“ Data path: /kaggle/input/anlp-ass1
ğŸ“ Working directory: /kaggle/working
âœ… Successfully imported custom modules
ğŸ”§ Configuration:
   DATA_PATH: /kaggle/input/anlp-ass1
============================================================
ğŸš€ Starting Transformer Testing on Kaggle
============================================================
ğŸ”§ Using device: cuda
   GPU: Tesla T4
   CUDA version: 12.4
ğŸ“¥ Using model: /kaggle/input/pos_bias/pytorch/default/1/best_model_poss_bias.pt
ğŸ“¥ Loading model from /kaggle/input/pos_bias/pytorch/default/1/best_model_poss_bias.pt
âœ… Model loaded successfully!
ğŸ”§ Positional encoding: relative_bias
ğŸ”§ Relative attention buckets: 32
ğŸ”§ Relative attention max distance: 128
ğŸ“Š Source vocab size: 10,000
ğŸ“Š Target vocab size: 10,000
ğŸ¤– Model parameters: 15,078,064

============================================================
ğŸ§ª Testing sample sentences...

============================================================
ğŸ§ª SAMPLE SENTENCE TESTING
============================================================

1. Finnish: HyvÃ¤Ã¤ huomenta
   Greedy:       the european parliament
   Conservative: on the european parliament
   Balanced:     at the on the european parliament
   Creative:     in the also to of the european way
   Beam:         the european parliament
   Beam-Alt:     the european parliament

2. Finnish: Kiitos paljon
   Greedy:       the european parliament
   Conservative: it is
   Balanced:     it is the community
   Creative:     would european development
   Beam:         the european parliament
   Beam-Alt:     the european parliament

3. Finnish: NÃ¤hdÃ¤Ã¤n myÃ¶hemmin
   Greedy:       the european parliament
   Conservative: i
   Balanced:     are
   Creative:     about i report debates
   Beam:         the european parliament
   Beam-Alt:     the european parliament

4. Finnish: MikÃ¤ on nimesi?
   Greedy:       the european parliament
   Conservative:
   Balanced:     we no - to the european parliament
   Creative:     there or not will take have which also at not
   Beam:         the european parliament
   Beam-Alt:     the european parliament

5. Finnish: PidÃ¤n kahvista
   Greedy:       the european parliament
   Conservative: in the european parliament
   Balanced:     the commission's is
   Creative:     it is also and
   Beam:         the european parliament
   Beam-Alt:     the european parliament

6. Finnish: SÃ¤Ã¤ on kaunis tÃ¤nÃ¤Ã¤n
   Greedy:       the european parliament
   Conservative: i is the european an
   Balanced:     these no from the not
   Creative:     - i
   Beam:         the european parliament
   Beam-Alt:     the european parliament

7. Finnish: Voitko auttaa minua?
   Greedy:       the european parliament
   Conservative: this is have the community of the commission
   Balanced:     of the european by
   Creative:     that the commission who of first
   Beam:         the european parliament
   Beam-Alt:     the european parliament

8. Finnish: Olen opiskelija
   Greedy:       the european parliament
   Conservative: a union has
   Balanced:     i would you
   Creative:     debates for transit
   Beam:         the european parliament
   Beam-Alt:     the european parliament

ğŸ’¾ Sample translations saved to /kaggle/working/sample_translations.csv

ğŸ” VOCABULARY DEBUG INFO:
   UNK token: '<UNK>' (idx: 3)
   SOS token: '<SOS>' (idx: 1)
   EOS token: '<EOS>' (idx: 2)
   PAD token: '<PAD>' (idx: 0)
   Target vocab size: 10000

============================================================
ğŸ¯ Running single strategy evaluation...
Selected strategy: greedy

================================================================================
ğŸ¯ SINGLE STRATEGY EVALUATION: GREEDY
================================================================================
ğŸ“ Loading test data...
âœ… Using full test set: 10,000 sentences

ğŸ“Š Test set size: 10000 sentence pairs
ğŸ¤– Model: relative_bias positional encoding
âš™ï¸  Parameters: 15,078,064
ğŸ­ Strategy: GREEDY
================================================================================
âš¡ Generating translations with Greedy decoding...
Greedy Translation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [19:07<00:00,  8.71it/s]

ğŸ“ Translation Examples (first 5):

--- Example 1 ---
Source (FI):  Jos me haluamme kansalaistemme hyvÃ¤ksynnÃ¤n, me emme mielestÃ¤ni voi enÃ¤Ã¤ vain niellÃ¤ sitÃ¤, ettÃ¤ kansalaisten selÃ¤n takana neuvotellaan niin, ettÃ¤ me voimme vain nyÃ¶kÃ¤tÃ¤ tai ravistaa pÃ¤Ã¤tÃ¤mme, millÃ¤ ei kuitenkaan ole mitÃ¤Ã¤n vaikutusta pÃ¤Ã¤tÃ¶kseen!
Reference:    The stage directions for this theatre of the absurd were, of course, set out in the Euratom Treaty. I think if we want our citizens to accept us, we can no longer allow agreements to be negotiated behind their backs, to which all we can do is nod or shake our heads, which has no effect on the final decision!
Greedy      : the european parliament of the commission and the commission to the commission of the commission of the commission of the commission of the commission of the commission of the commission of the commission of the commission of the commission of the commission of the commission

--- Example 2 ---
Source (FI):  Sen Singaporen konferenssi osoitti selvÃ¤sti.
Reference:    The old state trade squabbles have now gone.
Greedy      : the european parliament

--- Example 3 ---
Source (FI):  Haluaisin kertoa teille siitÃ¤ alueellisen poliittisen ulottuvuuden heikkoudesta, jonka havaitsin ja josta olen erittÃ¤in pahoillani.
Reference:    This measure makes it possible to carry out inspections at the port of disembarkation and apply sanctions up to a maximum of impounding the vessel if irregularities are found.
Greedy      : the european parliament of the commission and the european parliament

--- Example 4 ---
Source (FI):  Johdanto
Reference:    Introduction
Greedy      : the european parliament

--- Example 5 ---
Source (FI):  WEU:n integroiminen EU: iin on ristiriidassa Ruotsin puolueettomuuspolitiikan kanssa, eikÃ¤ sitÃ¤ voida hy vÃ¤ksyÃ¤.
Reference:    A lot more will have to be done at WTO level to combine policy on the envhonment, social standards and development policy to further liberalization.
Greedy      : the european parliament of the commission and the commission to the commission

ğŸ“ˆ EVALUATION RESULTS
==================================================
ğŸ¯ BLEU Score (greedy): 0.0230

ğŸ“Š DETAILED METRICS:
  BLEU Score:      0.0230
  Exact Match:     0.00%
  Word Accuracy:   2.62%
  Avg Length:      18.9 words (ref: 23.0)

ğŸ’¾ Results saved:
  ğŸ“„ Detailed results: /kaggle/working/greedy_test_results.csv
  ğŸ“Š Summary metrics: /kaggle/working/greedy_evaluation_summary.json
================================================================================

âœ… Testing completed successfully!
ğŸ¯ BLEU Score (greedy): 0.0230
ğŸ“Š Test Sentences: 10,000
ğŸ­ Strategy: GREEDY