    config = {
        'd_model': 256,  # Reduced from 512 to 256 for easier training
        'num_heads': 8,
        'num_encoder_layers': 4,  # Reduced from 6 to 4
        'num_decoder_layers': 4,  # Reduced from 6 to 4
        'd_ff': 1024,  # Reduced from 2048 to 1024
        'max_seq_len': 128,
        'dropout': 0.2,  # Increased from 0.1 to 0.2 for better regularization
        'pos_encoding_type': 'relative_bias',  # Changed from 'rope' to 'relative_bias'
        'batch_size': 16,  # Reduced from 32 to 16 for more stable gradients
        'learning_rate': 1e-3,  # Increased from 2e-4 to 1e-3 for faster learning
        'num_epochs': 15,  # Increased from 10 to 15 for more training time
        'warmup_steps': 500,  # Reduced from 2000 to 500 for faster ramp-up
        'vocab_size': 10000,
        'save_every': 1000,
        'eval_every': 200,  # More frequent evaluation
        'label_smoothing': 0.0,  # Completely disabled
        'use_label_smoothing': False,  # Ensure cross entropy is used
        'weight_decay': 1e-4,  # Add weight decay for regularization
        'gradient_clip': 0.5,  # Reduced gradient clipping
        # Relative position bias specific parameters
        'relative_attention_num_buckets': 32,  # Number of relative position buckets
        'relative_attention_max_distance': 128,  # Maximum relative distance
    }


📁 Data path: /kaggle/input/anlp-ass1
📁 Working directory: /kaggle/working
✅ Successfully imported custom modules
🔧 Configuration:
   DATA_PATH: /kaggle/input/anlp-ass1
============================================================
🚀 Starting Transformer Testing on Kaggle
============================================================
🔧 Using device: cuda
   GPU: Tesla T4
   CUDA version: 12.4
📥 Using model: /kaggle/input/pos_bias/pytorch/default/1/best_model_poss_bias.pt
📥 Loading model from /kaggle/input/pos_bias/pytorch/default/1/best_model_poss_bias.pt
✅ Model loaded successfully!
🔧 Positional encoding: relative_bias
🔧 Relative attention buckets: 32
🔧 Relative attention max distance: 128
📊 Source vocab size: 10,000
📊 Target vocab size: 10,000
🤖 Model parameters: 15,078,064

============================================================
🧪 Testing sample sentences...

============================================================
🧪 SAMPLE SENTENCE TESTING
============================================================

1. Finnish: Hyvää huomenta
   Greedy:       the european parliament
   Conservative: we have in the member
   Balanced:     the parliament
   Creative:     it that the european if
   Beam:         the european parliament
   Beam-Alt:     the european parliament

2. Finnish: Kiitos paljon
   Greedy:       the european parliament
   Conservative: - is a european parliament
   Balanced:     president, of the european parliament
   Creative:     the time
   Beam:         the european parliament
   Beam-Alt:     the european parliament

3. Finnish: Nähdään myöhemmin
   Greedy:       the european parliament
   Conservative: we have to the commission
   Balanced:     the european
   Creative:     this is by
   Beam:         the european parliament
   Beam-Alt:     the european parliament

4. Finnish: Mikä on nimesi?
   Greedy:       the european parliament
   Conservative:
   Balanced:     i will and of the european
   Creative:     are mr this of the commission and an than
   Beam:         the european parliament
   Beam-Alt:     the european parliament

5. Finnish: Pidän kahvista
   Greedy:       the european parliament
   Conservative: we is have
   Balanced:     i member
   Creative:     it is
   Beam:         the european parliament
   Beam-Alt:     the european parliament

6. Finnish: Sää on kaunis tänään
   Greedy:       the european parliament
   Conservative: in the european parliament
   Balanced:     - to take be in this a council to by the european parliament and the necessary as the need
   Creative:     of is i a the european we
   Beam:         the european parliament
   Beam-Alt:     the european parliament

7. Finnish: Voitko auttaa minua?
   Greedy:       the european parliament
   Conservative: in the european of the union
   Balanced:     we this member would
   Creative:     i
   Beam:         the european parliament
   Beam-Alt:     the european parliament

8. Finnish: Olen opiskelija
   Greedy:       the european parliament
   Conservative: the report
   Balanced:     is on the european parliament
   Creative:     what for the
   Beam:         the european parliament
   Beam-Alt:     the european parliament

💾 Sample translations saved to /kaggle/working/sample_translations.csv

🔍 VOCABULARY DEBUG INFO:
   UNK token: '<UNK>' (idx: 3)
   SOS token: '<SOS>' (idx: 1)
   EOS token: '<EOS>' (idx: 2)
   PAD token: '<PAD>' (idx: 0)
   Target vocab size: 10000

============================================================
🎯 Running single strategy evaluation...
Selected strategy: conservative

================================================================================
🎯 SINGLE STRATEGY EVALUATION: CONSERVATIVE
================================================================================
📁 Loading test data...
✅ Using full test set: 10,000 sentences

📊 Test set size: 10000 sentence pairs
🤖 Model: relative_bias positional encoding
⚙️  Parameters: 15,078,064
🎭 Strategy: CONSERVATIVE
================================================================================
🛡️  Generating translations with Conservative top-k...
Conservative Translation: 100%|██████████| 10000/10000 [24:43<00:00,  6.74it/s]

📝 Translation Examples (first 5):

--- Example 1 ---
Source (FI):  Palontorjuntaan on kiinnitettävä enemmän huomiota ennaltaehkäisyä ja valvontaa kannustamalla.
Reference:    Methods for conserving genetic resources must be strengthened by encouraging seed selection and improvement.
Conservative: it is this by the

--- Example 2 ---
Source (FI):  Neljänneksi valitetaan myönteisen ilmapiirin puutetta. Opiskelijoiden kouluttaminen merkitsee kuitenkin kilpailukyvyn lisääntymistä ja individualismia, ja tämä voi haitata mainitun myönteisen ilmapiirin syntymistä.
Reference:    I therefore read Mr Rovsing's report with great interest, and I can say that I accept, that the Socialist .group accepts, many of the observations, reflections and proposals contained in that report.
Conservative: i the european is the new to be a of the committee for the commission that the commission and it a of the european

--- Example 3 ---
Source (FI):  Tämän vuoksi meidän on joka tapauksessa huolehdittava siitä, että siirtymäsäännöstöä parannetaan ja yksinkertaistetaan.
Reference:    We must therefore see to it that the transitional rules are improved and simplified.
Conservative: we the european be it is in that is a which and with the are in the commission that as is the commission has are to the council of the european by the in the european which that is in this of the member

--- Example 4 ---
Source (FI):  Toivonkipinä elää ikuisesti!
Reference:    If Parliament wants to go to a conciliation procedure that would be interesting -and relevant!
Conservative: in the commission for the

--- Example 5 ---
Source (FI):  Lisäksi suosittelemme, että näiden tuotteiden kuljetusta varten
Reference:    Seizures of illegal merchandise in the territory of the Member State.
Conservative: i the european and we are of the member

📈 EVALUATION RESULTS
==================================================
🎯 BLEU Score (conservative): 0.0897

📊 DETAILED METRICS:
  BLEU Score:      0.0897
  Exact Match:     0.15%
  Word Accuracy:   2.36%
  Avg Length:      22.4 words (ref: 23.1)

💾 Results saved:
  📄 Detailed results: /kaggle/working/conservative_test_results.csv
  📊 Summary metrics: /kaggle/working/conservative_evaluation_summary.json
================================================================================

✅ Testing completed successfully!
🎯 BLEU Score (conservative): 0.0897
📊 Test Sentences: 10,000
🎭 Strategy: CONSERVATIVE
