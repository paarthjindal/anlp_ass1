rope with beam comparable


ğŸ“ Data path: /kaggle/input/anlp-ass1
ğŸ“ Working directory: /kaggle/working
âœ… Successfully imported custom modules
ğŸ”§ Configuration:
   DATA_PATH: /kaggle/input/anlp-ass1
============================================================
ğŸš€ Starting Transformer Testing on Kaggle
============================================================
ğŸ”§ Using device: cuda
   GPU: Tesla T4
   CUDA version: 12.4
ğŸ“¥ Using model: /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
ğŸ“¥ Loading model from /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
âœ… Model loaded successfully!
ğŸ”§ Positional encoding: rope
ğŸ”§ Using RoPE (Rotary Position Embeddings)
ğŸ“Š Source vocab size: 10,000
ğŸ“Š Target vocab size: 10,000
ğŸ¤– Model parameters: 15,053,584

============================================================
ğŸ§ª Testing sample sentences...

============================================================
ğŸ§ª SAMPLE SENTENCE TESTING
============================================================

1. Finnish: HyvÃ¤Ã¤ huomenta
   Greedy:       the european
   Conservative: to the european
   Balanced:     for - as the
   Creative:     we where the commission for like
   Beam-Comp:    the european of the
   Beam:         i of the european
   Beam-Alt:     i of the european

2. Finnish: Kiitos paljon
   Greedy:       the european
   Conservative: the of i
   Balanced:     which be
   Creative:     will
   Beam-Comp:    i
   Beam:         i of the european
   Beam-Alt:     i of the european

3. Finnish: NÃ¤hdÃ¤Ã¤n myÃ¶hemmin
   Greedy:       the european
   Conservative: the parliament of the european
   Balanced:     but this of the european
   Creative:     at the one of this it
   Beam-Comp:    the european
   Beam:         i of the european
   Beam-Alt:     i of the european

4. Finnish: MikÃ¤ on nimesi?
   Greedy:       the european of the european
   Conservative: i the european on that are
   Balanced:     i of the commission not on in the
   Creative:     of the in the commission with the european of a any
   Beam-Comp:    i the european of the commission
   Beam:         the european of the european
   Beam-Alt:     the european of the european

5. Finnish: PidÃ¤n kahvista
   Greedy:       the european
   Conservative: we
   Balanced:     in the union parliament who
   Creative:
   Beam-Comp:    the commission to be
   Beam:         i of the european
   Beam-Alt:     i of the european

6. Finnish: SÃ¤Ã¤ on kaunis tÃ¤nÃ¤Ã¤n
   Greedy:       the european of the european
   Conservative: we that is that the commission
   Balanced:     i the not of these is the commission of the committee
   Creative:     the european
   Beam-Comp:    in the european
   Beam:         the european of the european of the
   Beam-Alt:     the european of the european

7. Finnish: Voitko auttaa minua?
   Greedy:       the european of the european
   Conservative: it are a for the commission of the european
   Balanced:     of the basis
   Creative:     be given that the parliament of the european
   Beam-Comp:    in the european of the commission
   Beam:         i of the european
   Beam-Alt:     the european of the european

8. Finnish: Olen opiskelija
   Greedy:       the european
   Conservative: the community and this of a european
   Balanced:     it is
   Creative:     the area of which
   Beam-Comp:    in the european of the european
   Beam:         i of the european
   Beam-Alt:     i of the european

ğŸ’¾ Sample translations saved to /kaggle/working/sample_translations.csv

ğŸ” VOCABULARY DEBUG INFO:
   UNK token: '<UNK>' (idx: 3)
   SOS token: '<SOS>' (idx: 1)
   EOS token: '<EOS>' (idx: 2)
   PAD token: '<PAD>' (idx: 0)
   Target vocab size: 10000

============================================================
ğŸ¯ Running single strategy evaluation...
Selected strategy: beam_comparable

================================================================================
ğŸ¯ SINGLE STRATEGY EVALUATION: BEAM_COMPARABLE
================================================================================
ğŸ“ Loading test data...
âœ… Using full test set: 10,000 sentences

ğŸ“Š Test set size: 10000 sentence pairs
ğŸ¤– Model: rope positional encoding
âš™ï¸  Parameters: 15,053,584
ğŸ­ Strategy: BEAM_COMPARABLE
================================================================================
ğŸ¯ Generating translations with Beam-comparable top-k...
Beam-Comparable Translation: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10000/10000 [28:19<00:00,  5.88it/s]

ğŸ“ Translation Examples (first 5):

--- Example 1 ---
Source (FI):  Me aiomme tiedottaa sÃ¤Ã¤nnÃ¶llisesti, miten ne edistyvÃ¤t jÃ¤senyysehtojen tÃ¤yttÃ¤misessÃ¤, ja suosittelemme, ettÃ¤ jÃ¤senyysneuvottelut aloitetaan heti, kun ne ovat valmiita.
Reference:    Van den Broek the basis of these reports, the Commission will be able to judge when to recommend to the Council that further accession negotiations be opened.
Beam_comparable: the commission of the commission and the that the european to the european of the commission

--- Example 2 ---
Source (FI):  EUROOPAN PARLAMENTTI
Reference:    EUROPEAN PARLIAMENT
Beam_comparable: the european

--- Example 3 ---
Source (FI):  2) IstuntokÃ¤sittelyn 10.12.1996 sanatarkan mietinnÃ¶n liite, s. 15
Reference:    2) Annex to the Verbatim report of proceedings of 10 December 1996, p. 15
Beam_comparable: i the commission of a in the commission

--- Example 4 ---
Source (FI):  PyytÃ¤isin rouva SchleicheriÃ¤ kuitenkin hy vÃ¤ksymÃ¤Ã¤n suullisen lisÃ¤yksen, jossa tarkennetaan, ettÃ¤ menetelmien on oltava YK:n yleissopimuksen mukaisesti hyvÃ¤ksyttyjen uusimpien standardien mukaisia.
Reference:    I would like to thank Parliament once again for the thorough debate and also for the interest it has thereby shown in the active participation of NGOs in the political work.
Beam_comparable: the european of this and the european

--- Example 5 ---
Source (FI):  Kannatan tutkimus toiminnan ja myÃ¶s tulevaisuuden tutkimusten lisÃ¤Ã¤mistÃ¤, mutta tuotannon kehittÃ¤miseksi sekÃ¤ epÃ¤rehellisen kilpailun ja sosiaalisen dumppauksen torjumiseksi tarvitaan laajempia toimenpiteitÃ¤.
Reference:    I support an increase in research and also in forecasting studies, but more is needed in order to develop production and to combat unfair competition and social dumping.
Beam_comparable: it to the of the european of the european

ğŸ“ˆ EVALUATION RESULTS
==================================================
ğŸ¯ BLEU Score (beam_comparable): 0.0557

ğŸ¤– Calculating BERTScore...
tokenizer_config.json:â€‡100%
â€‡48.0/48.0â€‡[00:00<00:00,â€‡5.43kB/s]
config.json:â€‡100%
â€‡483/483â€‡[00:00<00:00,â€‡67.1kB/s]
vocab.txt:â€‡100%
â€‡232k/232kâ€‡[00:00<00:00,â€‡5.92MB/s]
tokenizer.json:â€‡100%
â€‡466k/466kâ€‡[00:00<00:00,â€‡8.25MB/s]
2025-09-09 19:58:04.937372: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1757447885.172322      36 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1757447885.240143      36 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
model.safetensors:â€‡100%
â€‡268M/268Mâ€‡[00:01<00:00,â€‡291MB/s]
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
ğŸ“Š BERTScore Results:
   Precision: 0.7038
   Recall:    0.6793
   F1:        0.6910

ğŸ“Š DETAILED METRICS:
  BLEU Score:      0.0557
  BERTScore F1:    0.6910
  BERTScore Prec:  0.7038
  BERTScore Rec:   0.6793
  Exact Match:     0.03%
  Word Accuracy:   2.64%
  Avg Length:      16.1 words (ref: 23.3)

ğŸ’¾ Results saved:
  ğŸ“„ Detailed results: /kaggle/working/beam_comparable_test_results.csv
  ğŸ“Š Summary metrics: /kaggle/working/beam_comparable_evaluation_summary.json
================================================================================

âœ… Testing completed successfully!
ğŸ¯ BLEU Score (beam_comparable): 0.0557
ğŸ“Š Test Sentences: 10,000
ğŸ­ Strategy: BEAM_COMPARABLE