rope with beam comparable


📁 Data path: /kaggle/input/anlp-ass1
📁 Working directory: /kaggle/working
✅ Successfully imported custom modules
🔧 Configuration:
   DATA_PATH: /kaggle/input/anlp-ass1
============================================================
🚀 Starting Transformer Testing on Kaggle
============================================================
🔧 Using device: cuda
   GPU: Tesla T4
   CUDA version: 12.4
📥 Using model: /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
📥 Loading model from /kaggle/input/rope_topk/pytorch/default/1/best_model.pt
✅ Model loaded successfully!
🔧 Positional encoding: rope
🔧 Using RoPE (Rotary Position Embeddings)
📊 Source vocab size: 10,000
📊 Target vocab size: 10,000
🤖 Model parameters: 15,053,584

============================================================
🧪 Testing sample sentences...

============================================================
🧪 SAMPLE SENTENCE TESTING
============================================================

1. Finnish: Hyvää huomenta
   Greedy:       the european
   Conservative: to the european
   Balanced:     for - as the
   Creative:     we where the commission for like
   Beam-Comp:    the european of the
   Beam:         i of the european
   Beam-Alt:     i of the european

2. Finnish: Kiitos paljon
   Greedy:       the european
   Conservative: the of i
   Balanced:     which be
   Creative:     will
   Beam-Comp:    i
   Beam:         i of the european
   Beam-Alt:     i of the european

3. Finnish: Nähdään myöhemmin
   Greedy:       the european
   Conservative: the parliament of the european
   Balanced:     but this of the european
   Creative:     at the one of this it
   Beam-Comp:    the european
   Beam:         i of the european
   Beam-Alt:     i of the european

4. Finnish: Mikä on nimesi?
   Greedy:       the european of the european
   Conservative: i the european on that are
   Balanced:     i of the commission not on in the
   Creative:     of the in the commission with the european of a any
   Beam-Comp:    i the european of the commission
   Beam:         the european of the european
   Beam-Alt:     the european of the european

5. Finnish: Pidän kahvista
   Greedy:       the european
   Conservative: we
   Balanced:     in the union parliament who
   Creative:
   Beam-Comp:    the commission to be
   Beam:         i of the european
   Beam-Alt:     i of the european

6. Finnish: Sää on kaunis tänään
   Greedy:       the european of the european
   Conservative: we that is that the commission
   Balanced:     i the not of these is the commission of the committee
   Creative:     the european
   Beam-Comp:    in the european
   Beam:         the european of the european of the
   Beam-Alt:     the european of the european

7. Finnish: Voitko auttaa minua?
   Greedy:       the european of the european
   Conservative: it are a for the commission of the european
   Balanced:     of the basis
   Creative:     be given that the parliament of the european
   Beam-Comp:    in the european of the commission
   Beam:         i of the european
   Beam-Alt:     the european of the european

8. Finnish: Olen opiskelija
   Greedy:       the european
   Conservative: the community and this of a european
   Balanced:     it is
   Creative:     the area of which
   Beam-Comp:    in the european of the european
   Beam:         i of the european
   Beam-Alt:     i of the european

💾 Sample translations saved to /kaggle/working/sample_translations.csv

🔍 VOCABULARY DEBUG INFO:
   UNK token: '<UNK>' (idx: 3)
   SOS token: '<SOS>' (idx: 1)
   EOS token: '<EOS>' (idx: 2)
   PAD token: '<PAD>' (idx: 0)
   Target vocab size: 10000

============================================================
🎯 Running single strategy evaluation...
Selected strategy: beam_comparable

================================================================================
🎯 SINGLE STRATEGY EVALUATION: BEAM_COMPARABLE
================================================================================
📁 Loading test data...
✅ Using full test set: 10,000 sentences

📊 Test set size: 10000 sentence pairs
🤖 Model: rope positional encoding
⚙️  Parameters: 15,053,584
🎭 Strategy: BEAM_COMPARABLE
================================================================================
🎯 Generating translations with Beam-comparable top-k...
Beam-Comparable Translation: 100%|██████████| 10000/10000 [28:19<00:00,  5.88it/s]

📝 Translation Examples (first 5):

--- Example 1 ---
Source (FI):  Me aiomme tiedottaa säännöllisesti, miten ne edistyvät jäsenyysehtojen täyttämisessä, ja suosittelemme, että jäsenyysneuvottelut aloitetaan heti, kun ne ovat valmiita.
Reference:    Van den Broek the basis of these reports, the Commission will be able to judge when to recommend to the Council that further accession negotiations be opened.
Beam_comparable: the commission of the commission and the that the european to the european of the commission

--- Example 2 ---
Source (FI):  EUROOPAN PARLAMENTTI
Reference:    EUROPEAN PARLIAMENT
Beam_comparable: the european

--- Example 3 ---
Source (FI):  2) Istuntokäsittelyn 10.12.1996 sanatarkan mietinnön liite, s. 15
Reference:    2) Annex to the Verbatim report of proceedings of 10 December 1996, p. 15
Beam_comparable: i the commission of a in the commission

--- Example 4 ---
Source (FI):  Pyytäisin rouva Schleicheriä kuitenkin hy väksymään suullisen lisäyksen, jossa tarkennetaan, että menetelmien on oltava YK:n yleissopimuksen mukaisesti hyväksyttyjen uusimpien standardien mukaisia.
Reference:    I would like to thank Parliament once again for the thorough debate and also for the interest it has thereby shown in the active participation of NGOs in the political work.
Beam_comparable: the european of this and the european

--- Example 5 ---
Source (FI):  Kannatan tutkimus toiminnan ja myös tulevaisuuden tutkimusten lisäämistä, mutta tuotannon kehittämiseksi sekä epärehellisen kilpailun ja sosiaalisen dumppauksen torjumiseksi tarvitaan laajempia toimenpiteitä.
Reference:    I support an increase in research and also in forecasting studies, but more is needed in order to develop production and to combat unfair competition and social dumping.
Beam_comparable: it to the of the european of the european

📈 EVALUATION RESULTS
==================================================
🎯 BLEU Score (beam_comparable): 0.0557

🤖 Calculating BERTScore...
tokenizer_config.json: 100%
 48.0/48.0 [00:00<00:00, 5.43kB/s]
config.json: 100%
 483/483 [00:00<00:00, 67.1kB/s]
vocab.txt: 100%
 232k/232k [00:00<00:00, 5.92MB/s]
tokenizer.json: 100%
 466k/466k [00:00<00:00, 8.25MB/s]
2025-09-09 19:58:04.937372: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1757447885.172322      36 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1757447885.240143      36 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
model.safetensors: 100%
 268M/268M [00:01<00:00, 291MB/s]
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
Warning: Empty candidate sentence detected; setting raw BERTscores to 0.
📊 BERTScore Results:
   Precision: 0.7038
   Recall:    0.6793
   F1:        0.6910

📊 DETAILED METRICS:
  BLEU Score:      0.0557
  BERTScore F1:    0.6910
  BERTScore Prec:  0.7038
  BERTScore Rec:   0.6793
  Exact Match:     0.03%
  Word Accuracy:   2.64%
  Avg Length:      16.1 words (ref: 23.3)

💾 Results saved:
  📄 Detailed results: /kaggle/working/beam_comparable_test_results.csv
  📊 Summary metrics: /kaggle/working/beam_comparable_evaluation_summary.json
================================================================================

✅ Testing completed successfully!
🎯 BLEU Score (beam_comparable): 0.0557
📊 Test Sentences: 10,000
🎭 Strategy: BEAM_COMPARABLE